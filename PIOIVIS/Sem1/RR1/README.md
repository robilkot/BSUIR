# Расчётная работа 1 (indev)

<b>Вариант:</b> 6.4 через списки инцидентности

<b>Постановка задачи:</b> найти минимальное множество рёбер, удаление которых позволяет сделать граф планарным

<b>Определения:</b>

- Граф - геометрический объект, состоящий из точек (вершин) и линий, которые их соединяют (рёбер)
- Планарный граф - граф, который можно изобразить на плоскости без пересечений рёбер не по вершинам
- Изоморфизм графов - биекция между множествами вершин двух графов
- Подразделение графа - граф, полученный делением рёбер данного графа
- Исключение вершины - операция, обратная к подразделению графа
- Гомеоморфные графы - графы, для подразделений которых существует изоморфизм

<b>Описание алгоритма:</b>

*В коде присутствует множество комментариев, поэтому многие детали в этом описании опущены. В блоке "реализованные структуры и функции" дано краткое описание всех функций, реализованных для решения [под]задач*

1. Исключение всех возможных вершин из данного графа
2. Проверка на критерий планарности
  * Поиск подграфа К5 (1)
  * Поиск подграфа К3,3 (2)
3. Поиск общих рёбер найденных подграфов (если имеются), рассмотрение их как приоритетных для удаления
4. Удаление найденных ранее рёбер

(1) Поиск подграфа К5
1. Выделение подграфа, состоящего из вершин, степень которых 5 и более (такие вершины названы кандидатами 1 уровня)
2. Если кандидатов первого уровня менее 5, возвращение пустой граф 
3. Выделение подграфа из графа кандидатов 1 уровня по степени каждой вершины 4 и более (такие вершины названы кандидатами 2 уровня)
4. Если кандидатов второго уровня менее 5, возвращение пустой граф 
5. Поиск выполнен. Возвращаем подграф, содержащий К5 или несколько таковых

(2) Поиск подграфа К3,3
1. Выделение подграфа, состоящего из вершин, степень которых 3 и более (такие вершины названы кандидатами 1 уровня)
2. Составление всех возможных сочетаний по 6 вершин из графа кандидатов 1 уровня
3. Проверка каждого сочетания на содержание изоморфизма К3,3
  * Составление всех возможных сочетаний по 3 вершины из выбранного подграфа
  * Проверка, является ли выбранный набор из 3 вершин долей графа (если имеет 3 смежные вершины из другой доли)
  * Если дольность выявлена, удаление рёбер, инцидентных парам вершин из одной доли
4. Объединение найденных изоморфизмов в один граф
5. Возвращаем найденный подграф, содержащий К3,3 или несколько таковых

# Реализованные структуры и функции

<details><summary><b>Структуры</b></summary>
<br />

- Вершина

Включает в себя имя, список инцидентности (далее - СИ). Также имеет методы для получения степени и вывода своего СИ на экран

- Граф

Включает в себя массив вершин, метод определения, пустой ли граф, метод, возвращающий количество рёбер графа, а также метод для вывода СИ всех своих вершин

</details>

<details><summary><b>Функции</b></summary>
<br />

- GetVertexFromString

Функция чтения строки формата "имя - ребро - ребро - ... - ребро" в объект типа vertex

- GetGraphFromFile

Функция чтения графа из файла. Использует вышеуказанную функцию для построчного чтения вершин.

- WriteGraphToFile

Запись графа в указанный файл

- CleanVector

Вспомогательная функция для очистки векторов от дубликатов. В работе используется vector, а не set, из-за простоты обращения к элементам (без итераторов).

- GetNeighboorVertices

Функция для получения списка номеров вершин в графе, смежных с данной. Работает путём нахождения совпадений в СИ данной и других вершин

- Neighboors

Проверяет, являются ли две вершины в графе смежными, сравнивая их СИ

- CanBeExcluded

Проверяет, может ли вершина быть исключённой из графа. Условие - степень 2 данной вершины а также несмежность двух смежных данной вершине вершин.

- GetCommonVertices

Получает список номеров вершин, которые содержатся в обоих данных графах

- GetCommonEdges (перегружена)

Получает список рёбер, содержащихся в СИ двух данных вершин

Получает список рёбер, общих для двух данных графов

- GetEdgeNumber

Вспомогательная функция. Возвращает номер данного ребра из СИ данной вершины

- EcludeVertex

Исключает вершину из графа. Возвращает 1 при успешном выполнении, 0 если исключение невозможно

- ExcludeAllVertices

Использует вышеуказанную функцию для исключения всех возможных вершин из данного графа

- DeleteVertex

Удаляет данную вершину из данного графа. Также очищает СИ всех вершин, ранее смежных с удалённой, от рёбер, ведущих в никуда

- DeleteEdge

Удаляет данное ребро из данного графа

- CleanIncidenceList

Вспомогательная функция. Очищает СИ данной вершины данного графа от рёбер, ведущих в никуда

- CleanAllIncidenceList

Использует вышеуказанную функцию для очистки СИ всех вершин данного графа

- MergeVertex

 Добавляет данную вершину в данный граф. В случае конфликта имён вершин происходит слияние их СИ
 
- GetSubgraph_K5

Возвращает граф, содержащий все изоморфизмы подграфов данного графа полному графу К5 (часть проверки критерия планарности)

- GetSubgraph_K33

Возвращает подграф изоморфный полному двудольному графу К3,3 (часть проверки критерия планарности)

- MakePlanar

Удаляет из графа минимальное множество рёбер для превращения его в планарный

</details>


# Тестовые графы

![test_input1](https://user-images.githubusercontent.com/82116328/198360374-858575b6-ab34-4f06-b161-c5bb28b318ae.png)

В первом примере непланарность графа обеспечена подграфом К5 (1-5 вершины). Пример демонстрирует работу функций исключения вершин, а также поиска подграфов К5.

![test_input2](https://user-images.githubusercontent.com/82116328/198360385-b062b6ab-0e46-4224-a576-595152b71977.png)

Второй пример - полный граф К6. Неочевидное решение примера - удаление трёх рёбер.

![test_input3](https://user-images.githubusercontent.com/82116328/198360394-b58e6bc3-2a91-4740-a27b-791a60200038.png)

Третий пример - двудольный граф. Пример демонстрирует работоспособность функции нахождения подграфов К3,3

![test_input4](https://user-images.githubusercontent.com/82116328/198360406-7e4c9007-fcd7-4451-8775-32ea1035539b.png)

Четвертый пример - граф, содержащий как подграф К5, так и подграф К3,3. Пример демонстрирует работу функций для оптимального удаления рёбер: сперва программа пытается удалить рёбра, общие для двух непланарных подграфов, в то время как рёбра нижней части даже не считаются нужными нам.

![test_input5](https://user-images.githubusercontent.com/82116328/202480176-21bf8332-9f4f-4597-8783-972b179f2909.png)

Пятый пример - ещё один граф, содержащий как подграф К5, так и подграф К3,3. В отличие от предыдущего примера, здесь отличается их взаимное расположение, что затрудняет поиск.

# Выводы

Расчётная работа дала возможность ознакомится с некоторыми комплексными задачами теории графов, такими как поиск изоморфизмов и проверка графа на планарность. В ходе выполнения было изучено множество теоретического материала, а также изучены алгоритмы поиска изоморфизмов в графе. 

# Источники информации

Непосредственно использованные материалы:

1. https://en.wikipedia.org/wiki/Planar_graph - Теоретическая информация о критерии планарности
2. https://en.wikipedia.org/wiki/Homeomorphism_(graph_theory) - Теоретическая информация для решения подзадач (поиск изоморфизмов)
3. https://e-maxx.ru/algo/generating_combinations - Реализация алгоритма поиска сочетаний (применяется в поиске изоморфизмов)

Прочие материалы, ознакомление с которыми помогло разобраться в теме и найти решение:

1. https://dl.acm.org/doi/pdf/10.1145/321921.321925 - Алгоритм Ульмана для нахождения изоморфных подграфов
2. http://quaoar.su/blog/page/subgraph-isomorphism-for-feature-recognition - Замечательное объяснение работы алгоритма Ульмана с практическим примером
3. https://stackoverflow.com/questions/17480142/is-there-any-simple-example-to-explain-ullmann-algorithm - Ещё одно, более тривиальное, объяснение алгоритма Ульмана
4. http://elisey-ka.ru/dismat/38.htm - Поиск изоморфизмов путём сравнения матриц смежности графов
