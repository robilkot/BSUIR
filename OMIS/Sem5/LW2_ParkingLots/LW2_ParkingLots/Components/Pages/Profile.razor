@page "/profile"

@using LW2_ParkingLots.Model.Persistence
@using LW2_ParkingLots.Model.Services
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Identity

@* @attribute [Authorize] *@

<PageTitle>Profile</PageTitle>

@inject NavigationManager Navigation
@inject IProfileService _profileService

<div class="profile-container">
    <aside class="sidebar">
        <ul>
            <li @onclick="GoToHistory">История</li>
            <li @onclick="GoToHistory">Активные брони</li>
            <li @onclick="GoToHistory">Редактировать профиль</li>
            <li @onclick="GoToHistory">Забронировать место</li>
            <li @onclick="GoToHistory">Отзывы</li>
        </ul>
    </aside>

    <main class="profile-details">
        <div class="user-photo">
            <!-- Placeholder for user photo -->
            <img src="user-photo-placeholder.png" alt="User Photo">
        </div>
        
        <div class="user-info">
            <div>
                <label>Номер телефона</label>
                <p>@user.PhoneNumber</p>
            </div>
            <div>
                <label>Email</label>
                <p>@user.Email</p>
            </div>
            <div>
                <label>Имя</label>
                <p>@user.FullName</p>
            </div>
        </div>
    </main>
</div>

@code {
    [CascadingParameter]
    private HttpContext HttpContext { get; set; } = default!;

    private ApplicationUser user;

    private async Task GoToHistory()
    {
        Navigation.NavigateTo("/history");
    }

    protected override async Task OnInitializedAsync()
    {
        user = await _profileService.GetUserAsync(0);
    }
}