<UserControl 
	xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:vm="clr-namespace:LW5.ViewModels;assembly=LW5"
	xmlns:vm_msg="clr-namespace:LW5.ViewModels.Messages;assembly=LW5"
    x:Class="LW5.Views.UserMessageView"
	x:DataType="vm_msg:UserMessageViewModel">
	<Design.DataContext>
		<vm_msg:UserMessageViewModel/>
	</Design.DataContext>

	<UserControl.Styles>
		<Style
			Selector=":is(ContentControl).emotion">
			<Setter Property="Width" Value="30"/>
			<Setter Property="Height" Value="30"/>
			<Setter Property="Padding" Value="1"/>
			<Setter Property="CornerRadius" Value="15"/>
		</Style>
	</UserControl.Styles>

	<StackPanel
		Orientation="Vertical"
		Spacing="5">
		<Border
			Padding="8"
			BorderThickness="1"
			BorderBrush="#000000"
			CornerRadius="12">
			<StackPanel
				Orientation="Vertical"
				Spacing="8">
				<!--metadata-->
				<StackPanel
					Orientation="Horizontal"
					Spacing="10"
					DataContext="{Binding Metadata}"
					x:DataType="vm_msg:MessageMetadataViewModel">
					<TextBlock
						FontWeight="DemiBold"
						Text="{Binding Sender.Name}"/>
					<TextBlock
						Opacity="0.5"
						Text="{Binding Sent, StringFormat='HH:mm'}"/>
				</StackPanel>
				<!--content-->
				<Carousel
					IsVisible="{Binding Content.Images.Count, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
					Name="slides"
					ItemsSource="{Binding Content.Images}">
					<Carousel.PageTransition >
						<CompositePageTransition>
							<PageSlide Duration="0:00:00.150" Orientation="Horizontal" />
						</CompositePageTransition>
					</Carousel.PageTransition>
					<Carousel.ItemTemplate>
						<DataTemplate>
							<Image 
								MaxHeight="200"
								MaxWidth="200"
								Source="{Binding}" />
						</DataTemplate>
					</Carousel.ItemTemplate>
					<Carousel.Items>
					</Carousel.Items>
				</Carousel>
				
				<TextBlock
					Text="{Binding Content.Text}"/>

				<ItemsControl
					ItemsSource="{Binding Content.Links}">
					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate>
							<StackPanel
								Orientation="Vertical"
								Spacing="4"/>
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Grid
								ColumnDefinitions="auto, *">
								<Image
									Grid.Column="0"
									Margin="0 0 3 0"
									Height="16"
									Width="16"
									Source="{SvgImage /Assets/arrow-up-right-from-square-svgrepo-com.svg}"
									/>
								<HyperlinkButton
									Grid.Column="1"
									Margin="0"
									Padding="0"
									NavigateUri="{Binding .}"
									Content="{Binding .}"/>
							</Grid>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>
			</StackPanel>
		</Border>
		<!--reactions-->
		<StackPanel
			Margin="0 0 6 0"
			HorizontalAlignment="Right"
			Spacing="5"
			Orientation="Horizontal">
			<Button
				Classes="emotion">
				<Image
					Source="{SvgImage /Assets/face-frown-svgrepo-com.svg}"/>
			</Button>
			<Button
				Classes="emotion">
				<Image
					Source="{SvgImage /Assets/face-smile-svgrepo-com.svg}"/>
			</Button>
		</StackPanel>
	</StackPanel>
</UserControl>
